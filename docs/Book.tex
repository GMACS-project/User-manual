% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
]{book}
\title{Gmacs: mastering a stock assessment for Crustaceans species}
\author{Matthieu Veron and the GMACS development Team}
\date{2022-07-14}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Gmacs: mastering a stock assessment for Crustaceans species},
  pdfauthor={Matthieu Veron and the GMACS development Team},
  colorlinks=true,
  linkcolor={Maroon},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={blue},
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{apalike}

\begin{document}
\maketitle

{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{welcome}{%
\chapter*{Welcome}\label{welcome}}
\addcontentsline{toc}{chapter}{Welcome}

This is the online version of ``\emph{Gmacs: mastering a stock assessment for Crustaceans species}'',
a user guide book \textbf{\emph{currently under development}} and that aims to merge
and synthesize all the current and past work done by the Gmacs development team
since the inception of this project.

Statistical catch age models have several advantages over simple production
type models in that age and size composition data can be used to better inform
structural features such as recruitment variability, growth variability and
total mortality rates. There are a number of generic age-structured models in use
today (e.g., \href{https://vlab.noaa.gov/web/stock-synthesis}{Stock Synthesis},
\href{https://niwa.co.nz/fisheries/tools-resources/casal}{CASAL}, \ldots), but there are
very few generic size-based, or staged-based models that are used in stock assessment.

Gmacs is an integrated analysis modelling framework designed to develop size-structured
stock assessment models for crustacean species. Crab stocks of Alaska are managed
by the North Pacific Fishery Management Council (\href{http://npfmc.org}{NPFMC}). Some
stocks are assessed with integrated size-structured assessment models of the
form described in \citet{punt_review_2013}. Currently, most of these stocks are assessed using a stock-specific assessment model (e.g. \citet{zheng_bristol_2014}). In this context and with the aim of uniform the assessment process of these species, the Gmacs project aims to provide a software that will allow each stock to be assessed independently but using a single flexible modelling framework.

This book is designed to take you from knowing nothing about Gmacs and its utilities

\hypertarget{structure-of-the-book}{%
\section*{Structure of the book}\label{structure-of-the-book}}
\addcontentsline{toc}{section}{Structure of the book}

\begin{itemize}
\tightlist
\item
  Chapter \ref{Preface}: What is Gmacs - How to get it installed
\item
  Chapter \ref{orga}: File Organisation
\item
  Chapter \ref{data-file}: Data file description
\item
  Chapter \ref{ctr-file}: Control file description
\item
  Chapter \ref{Project}: Projection file description
\item
  Chapter \ref{Rgmacs}: A set of functions to help the user to fill/modify input files (have to be developed)
\item
  Chapter \ref{run-plot}: Running Gmacs and using the \texttt{gmr} package to plot results
\item
  Chapter \ref{first-gmacs}: Building your first stock assessment using Gmacs
\item
  Chapter \ref{sad}: Producing stock assessment documents
\item
  Chapter \ref{faq}: Frequently Asked Questions
\end{itemize}

\hypertarget{license}{%
\section*{License}\label{license}}
\addcontentsline{toc}{section}{License}

The Gmacs project has been and is still funded by the National Marine Fisheries Service and the Bering Sea Fisheries Research Foundation. This product is currently hosted by the Nation Oceanic and Atmospheric Administration (\href{https://www.noaa.gov/}{NOAA}).

\hypertarget{Preface}{%
\chapter{Preface}\label{Preface}}

\hypertarget{what-is-gmacs}{%
\section*{What is Gmacs ?}\label{what-is-gmacs}}
\addcontentsline{toc}{section}{What is Gmacs ?}

Gmacs is a statistical size-structured population modeling framework designed to be flexible, scalable, and useful for both data-limited and data-rich situations. As most of the standard assessment models, it allows to determine the impact fishing on both the historical and the current abundance of the population and to evaluate sustainable rate of removals (i.e., catches).

The framework can incorporate multiple data types from a variety of sources (fisheries, surveys) by combing all of them in the form of an integrated analysis \citep{maunder_review_2013, punt_review_2013}. This approach allows various kinds of data with different (and sometimes incomplete) collection histories to provide complementary information about fished stocks.

Initially developed to assess red king crab stocks of Alaska, Gmacs is designed with similar flexibility to that provided by age-structured stock assessment modelling frameworks like \href{https://vlab.noaa.gov/web/stock-synthesis}{Stock Synthesis} and \href{https://niwa.co.nz/fisheries/tools-resources/casal}{CASAL}. Similar to these model, Gmacs has a population sub-model that simulates stock biological dynamics (growth, maturity,fecundity, recruitment, molting), an observation sub-model that estimates expected values for different kind of data (e.g.~fishery and/or survey abundance indices, fisheries discard data, size composition data, \ldots) and a statistical sub-model that quantify the goodness of fit and provides best-fitting parameters estimates and associated variance.

Gmacs is an open source program coded in C++ and implemented in Automatic Differentiation Model Builder (\href{http://www.admb-project.org/}{ADMB}; \citet{fournier_ad_2012}) for parameter estimation.

\hypertarget{prerequisites}{%
\section*{Prerequisites}\label{prerequisites}}
\addcontentsline{toc}{section}{Prerequisites}

Before getting Gmacs installed, make sure you have all the software you need to run Gmacs (and associate tools) correctly:

\begin{itemize}
\item
  \textbf{AD Model Builder}: Gmacs is available for download as a series of source files. In order to use Gmacs, you will need to build these source files into an executable. To do this, you will need a recent version of AD Model Builder (\href{http://www.admb-project.org/}{ADMB}). We recommend downloading the latest version of ADMB from the \href{https://github.com/admb-project/admb}{ADMB GitHub repository} and building ADMB from source. Alternatively, recent pre-compiled builds of ADMB can be downloaded from \href{http://www.admb-project.org/downloads/}{the ADMB website}. Instructions for installing ADMB from pre-compiled builds can be found on the \href{http://www.admb-project.org/docs/install/}{ADMB website} as well. For more details about how work ADMB, please see the \href{http://www.admb-project.org/docs/manuals/}{user manual}.
\item
  \textbf{R}: If you are reading this book, you probably have R already installed. If that is not the case and you plan to use both the \texttt{gmr} package and the Rmarkdown resources to build stock assessment documents, you will need R. If you are a new R user and would like to learn how to use R, we would recommend the following two books \href{https://rc2e.com/index.html}{\emph{R cookbook}} and \href{https://r4ds.had.co.nz/}{\emph{R for data Science}} which are designed to get you up and running with R.
\item
  \textbf{Rstudio}: Despite any text editor can be used to view and edit Rmarkdown files, we recommend to use \href{https://www.rstudio.com/}{Rstudio} if you plan to use the Rmarkdown resources to build stock assessment documents. Its editor will make it easier to work with R Markdown. You can download Rstudio \href{https://www.rstudio.com/products/rstudio/download/}{here}.
\end{itemize}

\hypertarget{getting-gmacs-installed}{%
\section*{Getting Gmacs installed}\label{getting-gmacs-installed}}
\addcontentsline{toc}{section}{Getting Gmacs installed}

Here we provide detailed instruction on how to ho about installing Gmacs on the most popular operating systems (Windows, Mac or linux computers).

\hypertarget{installing-gmacs}{%
\subsection*{Installing Gmacs}\label{installing-gmacs}}
\addcontentsline{toc}{subsection}{Installing Gmacs}

The latest version of Gmacs can be download \href{}{here}.

\begin{itemize}
\tightlist
\item
  Quick start for windows machines

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    Download \href{https://github.com/seacode/gmacs/archive/develop.zip}{gmacs-develop.zip}.
  \item
    Unzip the folder to create \texttt{c:/gmacs-develop} or something similar.
  \item
    Open an ADMB Command windows.
  \item
    Navigate to \texttt{c:/gmacs-develop/src} and type \texttt{make.bat}.
  \item
    The Gmacs executable (\texttt{gmacs.exe}) should be built inside the \texttt{src/} folder.
  \item
    See Chapter 7 for building your own model.
  \end{enumerate}
\item
  Quick start for Mac machines

  \begin{enumerate}
  \def\labelenumi{\arabic{enumi}.}
  \tightlist
  \item
    Download \href{https://github.com/seacode/gmacs/archive/develop.zip}{gmacs-develop.zip}.
  \item
    Unzip the folder to create \texttt{/users/Your-name/gmacs-develop} or something similar.
  \item
    Open a Terminal
  \item
    Navigate to \texttt{/users/Your-name/gmacs-develop/src}.
  \item
    Edit the \texttt{make} file to reference your local machine.
  \item
    Return to Terminal and type \texttt{make} to get started.
  \item
    The Gmacs executable (\texttt{gmacs.exe}) should be built inside the \texttt{src/} folder.
  \item
    See Chapter 7 for building your own model.
  \end{enumerate}
\item
  Installation on Linux
\end{itemize}

Installing ADMB on Linux is easy via \href{https://github.com/}{GitHub}\ldots.

\hypertarget{what-are-the-available-tools-for-working-with-gmacs}{%
\section*{What are the available tools for working with Gmacs?}\label{what-are-the-available-tools-for-working-with-gmacs}}
\addcontentsline{toc}{section}{What are the available tools for working with Gmacs?}

Numerous tools have been developed to facilitate and spread the use of Gmacs. This include various repositories on GitHub as well as:

\begin{itemize}
\tightlist
\item
  \href{https://github.com/seacode/gmacs/tree/develop/gmr}{gmr}: a purpose-built R package for plotting Gmacs outputs and work with Gmacs files in R.
\item
  \href{}{Gmad}: a dedicated library to generate stock assessment documents in pdf form using Gmacs outputs.
\end{itemize}

\hypertarget{how-can-i-learn-how-to-use-gmacs-and-associated-tools}{%
\section*{How can I learn how to use Gmacs and associated tools?}\label{how-can-i-learn-how-to-use-gmacs-and-associated-tools}}
\addcontentsline{toc}{section}{How can I learn how to use Gmacs and associated tools?}

This book is the first place to learn more about how to use Gmacs. Its different chapters should make you able to start using Gmacs in a relatively simple way. To learn more about model equations and population dynamics considered within Gmacs, please see the general model description paper \href{}{to come}. We suggest walking through the available vignettes to familiarize with Gmacs.

The basic vignette included in the \href{https://github.com/seacode/gmacs/tree/develop/gmr}{gmr} R package provides help for installing the package and an overview of the available functions.

\hypertarget{how-can-i-get-help}{%
\section*{How can I get help?}\label{how-can-i-get-help}}
\addcontentsline{toc}{section}{How can I get help?}

The first thing to do is to have a look at the Frequently Asked Questions page.
beyond the FAQ page:

\begin{itemize}
\tightlist
\item
  Is there an specific email address where people can ask help?
\item
  Do you want to create a kind of forum?
\end{itemize}

\hypertarget{how-can-i-followcontribute-to-gmacs-development}{%
\section*{How can I follow/contribute to Gmacs development?}\label{how-can-i-followcontribute-to-gmacs-development}}
\addcontentsline{toc}{section}{How can I follow/contribute to Gmacs development?}

Should we consider the possibility for the user to report bugs or request features through an issue on GitHub, suggest code changes (pull request), or suggest changes to the Gmacs manual.

\hypertarget{how-can-i-report-issues}{%
\section*{How can I report issues?}\label{how-can-i-report-issues}}
\addcontentsline{toc}{section}{How can I report issues?}

Post in the Forum or open an issue in the Gmacs repo.

\hypertarget{the-gmacs-development-team}{%
\section*{The Gmacs development team}\label{the-gmacs-development-team}}
\addcontentsline{toc}{section}{The Gmacs development team}

Table \ref{tab:contr} summarizes the people who have worked on the Gmacs project since its inception.

Table:\label{tab:contr} Gmacs development team - Contributors.

\begin{tabular}{ll}
\toprule
Contributors & Organisation\\
\midrule
**Jim Ianelli** & Alaska Fisheries Science center - NOAA\\
**D'Arcy Webber** & Quantfish\\
**Cody Szuwalski** & Alaska Fisheries Science center - NOAA\\
**Jack Turnock** & Alaska Fisheries Science center - NOAA\\
**Jie Zheng** & Alaska Department of Fish and Game\\
\addlinespace
**Hamachan Hamazaki** & Alaska Department of Fish and Game\\
**Athol Whitten** & School of Aquatic and Fishery Sciences - University of Washington\\
**Andre Punt** & School of Aquatic and Fishery Sciences - University of Washington\\
**David Fournier** & Otter Research Ltd.\\
**John Levitt** & \\
\bottomrule
\end{tabular}

\hypertarget{orga}{%
\chapter{File organisation}\label{orga}}

Gmacs is controlled by a series of text-based input files. These files can be prepared and edited using a text editor of your choice.

\hypertarget{input-files}{%
\section{Input Files}\label{input-files}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{model.dat}: file containing model dimensions and the data (\emph{required}).
\item
  \texttt{model.ctl}: file containing set-up for the parameters and options chose (\emph{required}).
\item
  \texttt{model.prj}: file containing specifications for the reference points and projections (\emph{required}).
\item
  \texttt{gmacs.dat}: file containing the names of the files specified above and ordered as \texttt{.dat}, \texttt{.ctl}, \texttt{.prj}.
\end{enumerate}

\hypertarget{output-files}{%
\section{Output Files}\label{output-files}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \texttt{gmacs\_in.dat}: New version (`echo') of the data file with annotations.
\item
  \texttt{gmacs\_in.ctl}: New version (`echo') of the control file with annotations.
\item
  \texttt{gmacs\_in.prj}: New version (`echo') of the projection file with annotations.
\item
  \texttt{gmacs\_files\_in.dat}: Contains the names of the files that have been read as data file, control file and projection file.
\item
  \texttt{checkfile.rep}: It is produced during the read-in and calculation stages of a model run. It is useful for debugging
\item
  \texttt{.rep}: These are standard ADMB output files
\item
  \texttt{gradient}
\end{enumerate}

\hypertarget{data-file}{%
\chapter{Data File}\label{data-file}}

\hypertarget{summary-of-data-file-content}{%
\subsection{Summary of Data File content}\label{summary-of-data-file-content}}

\hypertarget{units-of-mesure}{%
\subsection{Units of mesure}\label{units-of-mesure}}

\begin{itemize}
\tightlist
\item
  Body size
\item
  Catch biomass
\item
  Survey abundance
\item
  Numbers
\item
  Output biomass
\item
  \ldots{}
\end{itemize}

\hypertarget{time-units}{%
\subsection{Time units}\label{time-units}}

\hypertarget{model-description}{%
\subsection{Model Description}\label{model-description}}

\hypertarget{ctr-file}{%
\chapter{Controle File}\label{ctr-file}}

\hypertarget{Project}{%
\chapter{Projection File}\label{Project}}

\hypertarget{Rgmacs}{%
\chapter{Working with Gmacs files within R}\label{Rgmacs}}

\hypertarget{run-plot}{%
\chapter{Running Gmacs and plotting results}\label{run-plot}}

\hypertarget{first-gmacs}{%
\chapter{Building your first Assessment}\label{first-gmacs}}

\hypertarget{sad}{%
\chapter{Producing Stock Assessment Document}\label{sad}}

\hypertarget{faq}{%
\chapter{Frequently Asked Questions}\label{faq}}

  \bibliography{References/book.bib,References/packages.bib,References/articles.bib}

\end{document}
